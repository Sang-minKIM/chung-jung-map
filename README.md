# 🌿 청정맵 (청년 정책 지도)

## 🗺️ 서비스 소개

청년들을 위한 맞춤형 정책 정보를 제공하는 웹 서비스입니다. 지역 기반의 다양한 청년 정책과 공고를 한눈에 파악하고, 개인에게 최적화된 정보를 쉽게 찾아볼 수 있도록 돕습니다. 복잡하고 분산된 정보를 통합하여 청년들이 더 나은 삶을 계획하고 실행하는 데 필요한 실질적인 지원을 받을 수 있도록 하는 것이 목표입니다.

## ✨ 주요 기능

-   **정책 목록 조회 및 상세 보기**: 지역별, 카테고리별 청년 정책을 조회하고 각 정책의 상세 내용을 확인할 수 있습니다.
-   **공고 목록 조회 및 상세 보기**: 다양한 기관에서 발표하는 청년 지원 공고를 목록으로 확인하고 상세 내용을 열람할 수 있습니다.
-   **정책-공고 유사도 기반 추천**: 특정 정책과 연관성이 높은 공고를 벡터 유사도 분석을 통해 추천하여, 사용자가 관심 있는 정책과 관련된 최신 공고를 놓치지 않도록 돕습니다.
-   **카테고리 필터링**: 정책 및 공고를 카테고리별로 필터링하여 원하는 정보만 효율적으로 검색할 수 있습니다.
-   **검색 기능**: 키워드를 통해 특정 정책이나 공고를 검색할 수 있습니다.
-   **반응형 웹 디자인**: 모바일, 태블릿, 데스크톱 등 다양한 기기에서 최적화된 사용자 경험을 제공합니다.

## 🛠️ 주요 기술 스택

### 🚀 Frontend

-   **React 19**: 가장 익숙하고 더 잘 활용해보고 싶어서 선택했습니다.
-   **TypeScript**: 정적 타입 체크를 통한 코드 안정성 향상을 위해 사용했습니다.
-   **Vite**: 빠른 개발 환경 제공 및 번들링, vitest를 통한 단위 테스트 환경 제공을 위해 사용했습니다.
-   **Emotion**: css prop, styled를 통한 스타일링 도구로 재사용 가능한 컴포넌트 기반 스타일을 구현하고 테마 시스템을 적용했습니다.
-   **TanStack Router**: 타입 세이프한 라우팅 제공, 파일 라우팅, TanStack Query와의 조합으로 데이터 로딩 등을 효과적으로 관리합니다.
-   **TanStack Query**: 서버 상태 관리, 데이터 fetching, 캐싱, 동기화 및 에러 처리를 간편하게 수행합니다.
-   **Zod**: 런타임 타입 검증 및 유효성 검사를 위한 스키마를 정의합니다.
-   **FxTS**: 지연 평가, 함수 합성 등으로 복잡한 로직을 선언적이게 작성할 수 있게 도와줍니다.

### ⚙️ Backend (Supabase Edge Functions)

Backend의 경우 cursor IDE의 AI Agent기능으로 90%이상의 코드를 작성했습니다.

-   **Supabase**: BaaS 플랫폼으로 서버, PostgreSQL을 사용합니다.
-   **Supabase Edge Functions (Deno 기반)**: 서버리스 함수. `notices` 및 `policies` API 엔드포인트를 구현하여 프론트엔드 요청을 처리합니다.
-   **Supabase pgvector**: 벡터 임베딩을 저장하고 유사도 검색을 수행합니다. 인덱스 기능을 통한 검색 성능 향상을 위해 사용합니다.
-   **Supabase CLI**: 마이그레이션 관리 및 Supabase 프로젝트 설정.
-   **Deno**: TypeScript 런타임으로, Edge Functions를 실행하는 환경입니다.
-   **`@supabase/supabase-js`**: Supabase 클라이언트 라이브러리로, Edge Functions에서 데이터베이스에 접근하는 데 사용됩니다.

## 💡 문제 해결

### 1. **재사용 가능한 UI 컴포넌트 설계 및 개발**

-   **고민**: 디자인 시스템을 구축하고 효율적인 UI 개발을 위해 재사용 가능한 컴포넌트들을 어떻게 설계하고 구현할 것인가? 특히 `Box` 컴포넌트를 기반으로 `Flex`, `Grid`, `Text`, `Heading` 등 다양한 레이아웃 및 타이포그래피 컴포넌트를 일관성 있게 확장하는 방법.
-   **해결**: `Emotion` 라이브러리의 `css` prop과 테마 시스템을 적극 활용하여 `Box` 컴포넌트를 최상위 기본 요소로 정의했습니다. `BoxProps` 인터페이스를 통해 스타일 프로퍼티를 체계화하고, `useTheme` 훅을 사용하여 테마 값을 컴포넌트에 적용했습니다. 이를 통해 모든 스타일 관련 컴포넌트가 `Box`의 유연성을 상속받으면서도 각자의 역할에 맞는 스타일을 쉽게 추가하고 재정의할 수 있도록 했습니다.

### 2. **타입 안전성을 고려한 라우팅 및 데이터 관리**

-   **고민**: `React Router`와 같은 기존 라우팅 라이브러리에서 발생하는 타입 예외 처리에 아주 많은 불편함을 느꼈습니다.
-   **해결**: `TanStack Router`를 도입하여 `zod`를 통한 라우트 타입 검증으로 타입 안전성을 확보했습니다. 각 라우트의 loader에서 필요한 데이터를 로딩하는 기능을 구현하여 컴포넌트 단에서 데이터 fetching 로직을 분리했습니다. 또한, `TanStack Query`를 사용하여 서버 상태를 효율적으로 관리하고, `queryOptions`와 `request` 함수를 통해 API 요청을 일관되게 처리함으로써 전반적인 애플리케이션의 안정성을 높였습니다.

### 3. **의미 기반 정책-공고 추천 기능 구현**

-   **고민**: 60여 개의 정책 데이터와 2,500개가 넘는 공고 데이터를 어떻게 의미적으로 연결할 것인가? 단순 키워드 매칭이나 SQL의 LIKE 검색으로는 두 데이터 간의 문맥적 연관성을 파악하기 어려웠습니다. 특히, 문서가 아닌 정형 데이터인 테이블 row를 어떻게 벡터로 임베딩하여 유사도를 측정할 것인가가 핵심 과제였습니다.

-   **해결**: 테이블의 각 row를 '컬럼: 값' 형태의 텍스트 문서로 취급하는 아이디어를 적용했습니다. 이 가상 문서를 임베딩하여 벡터 값을 추출하고, Supabase의 pgvector 확장을 사용해 벡터를 테이블의 컬럼으로 저장했습니다. 이를 통해 정책과 공고 데이터 간의 코사인 유사도(Cosine Similarity)를 측정하고, 가장 연관성 높은 공고를 추천하는 핵심 API를 직접 개발하여 서비스의 핵심 기능을 완성했습니다.
-   ![관련 PR]()

### 4. **함수형 프로그래밍을 통한 복잡한 UI 로직 개선**

-   **고민**: 검색, 필터링, 페이지네이션 로직이 중첩된 if문과 삼항 연산자로 복잡하게 얽혀 있어 가독성이 떨어지고 새로운 기능 추가가 어려운 상황이었습니다. 데이터의 흐름을 명확하게 표현하고, 각 로직을 독립적으로 재사용할 수 있는 선언적인 코드로 개선하는 것이 목표였습니다.

-   **해결**: FxTS 라이브러리를 도입하여 함수형 프로그래밍 스타일로 리팩토링을 진행했습니다. 데이터의 원본 배열을 시작으로 pipe 함수를 통해 filter, map 등의 함수를 파이프라인처럼 연결하여 데이터 처리 과정을 직관적으로 표현했습니다. 그 결과, 데이터가 어떤 과정을 거쳐 UI에 렌더링되는지 순서대로 명확하게 읽을 수 있게 되었으며, 새로운 필터 조건을 추가할 때도 파이프라인에 한 단계를 추가하기만 하면 되어 유지보수성이 크게 향상되었습니다.
-   ![관련 PR]()
